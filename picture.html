<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JavaScript 图片轮播</title>

<script type="text/javascript">
    var babyzone = function() {
        function id(name) {
            return document.getElementById(name);
        }

        function each(arr, callback) {
            if (arr.forEach) {
                arr.forEach(callback);
            } else {
                for (var i = 0, len = arr.length; i < len; i++) {

                    callback.call(this, arr[i], i, arr);
                }
            }


        }

        function fadeIn(elem) {
            setOpacity(elem, 0)
            for (var i = 0; i < 20; i++) {
                (function () {
                    var pos = i * 5;
                    setTimeout(function () {
                        setOpacity(elem, pos)
                    }, i * 25);
                })(i);
            }
        }


        function fadeOut(elem) {
            for (var i = 0; i <= 20; i++) {
                (function () {
                    var pos = 100 - i * 5;
                    setTimeout(function () {
                        setOpacity(elem, pos)
                    }, i * 25);
                })(i);

            }
        }


        function setOpacity(elem, level) {
            if (elem.filters) {
                elem.style.filter = "alpha(opacity=" + level + ")";
            } else {

                elem.style.opacity = level / 100;
            }
        }

        return {

            //count 图片数量,wrapId：包裹图片
            scroll :function(count,wrapId,ulId,infoId){
                var self = this;
                var targetIdx =0;
                var curIndex = 0;
                var frag=document.createDocumentFragment();
                this.num=[];
                this.info=id(infoId);
                for(var i =0; i<count;i++){
                    (this.num[i]=frag.appendChild(document.createElement("li"))).innerHTML=i+1;
                }
                console.log(frag);
                console.log(id(ulId));
                id(ulId).appendChild(frag);

                this.img =id(wrapId).getElementsByTagName("a");
                this.info.innerHTML = self.img[0].firstChild.title;
                this.num[0].className="on";
                each(this.img,function(elem,idx,arr){
                    if(idx !=0) setOpacity(elem,0);
                });

                each(this.num,function(elem,idx,arr){
                    elem.onclick=function(){
                        self.fade(idx,curIndex);
                        curIndex = idx;
                        targetIdx = idx;
                    }
                });

                //自动轮播效果
                var itv=setInterval(function(){
                    if(targetIdx<self.num.length-1){
                        targetIdx++;
                    }else{
                        targetIdx=0;
                    }
                    self.fade(targetIdx,curIndex);
                    curIndex=targetIdx;
                },2000);
                id(ulId).onmouseover=function(){ clearInterval(itv)};
                id(ulId).onmouseout=function(){
                    itv=setInterval(function(){
                        if(targetIdx<self.num.length-1){
                            targetIdx++;
                        }else{
                            targetIdx=0;
                        }
                        self.fade(targetIdx,curIndex);
                        curIndex=targetIdx;
                    },2000);
                }
            },
            fade:function(idx,lastIdx){
                if(idx==lastIdx) return;
                var self=this;
                fadeOut(self.img[lastIdx]);
                fadeIn(self.img[idx]);
                each(self.num,function(elem,elemidx,arr){
                    if (elemidx!=idx) {
                        self.num[elemidx].className='';
                    }else{
                        id("list").style.background="";
                        self.num[elemidx].className='on';
                    }
                });
                this.info.innerHTML=self.img[idx].firstChild.title;
            }
            }
        }();

</script>
<style type="text/css">
    #banner {position:relative; width:478px; height:286px; border:1px solid #666; overflow:hidden;}
    #banner_list img {border:0px;}
    #banner_bg {position:absolute; bottom:0;background-color:#000;height:30px;filter: Alpha(Opacity=30);opacity:0.3;z-index:1000;cursor:pointer; width:478px; }
    #banner_info{position:absolute; bottom:0; left:5px; line-height:30px;color:#fff;z-index:1001}
    #banner_text {position:absolute;width:120px;z-index:1002; right:3px; bottom:3px;}
    #banner ul {position:absolute;list-style-type:none;filter: Alpha(Opacity=75);opacity:0.75; border:1px solid #fff;z-index:1002;margin:0; padding:0; bottom:3px; right:5px;}
    #banner ul li { padding:0px 8px;float:left;display:block;color:#FFF;border:#fff 1px solid;background-color:#6f4f67;cursor:pointer}
    #banner ul li.on{ background-color:#900}
    #banner_list a{position:absolute;} <!-- 让四张图片都可以重叠在一起-->
</style>


</head>
<body>
<div id ="banner">
    <div id = "banner_bg"></div>
     <a href="#" id = "banner_info"></a>
    <ul id="list"></ul>
    <div id="banner_list">
        <a href="#" target="_blank"><img src="imgs/p1.jpg" title="Alex 's Picture one" alt="Alex 's Picture one "/></a>
        <a href="#" target="_blank"><img src="imgs/p2.jpg" title="Alex 's Picture two" alt="Alex 's Picture two "/></a>
        <a href="#" target="_blank"><img src="imgs/p3.jpg" title="Alex 's Picture three" alt="Alex 's Picture three "/></a>
        <a href="#" target="_blank"><img src="imgs/p4.jpg" title="Alex 's Picture four" alt="Alex 's Picture four "/></a>
        <a href="#" target="_blank"><img src="imgs/p5.jpg" title="Alex 's Picture five" alt="Alex 's Picture five "/></a>
    </div>
</div>
<script type="text/javascript">
    window.onload = function(){
        babyzone.scroll(5,"banner_list","list","banner_info");
    }
</script>
</body>
</html>